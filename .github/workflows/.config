# ImmortalWrt 24.10.2 空间优化配置
# 专门为 GitHub Actions 免费账户优化

# ====== 基础平台配置 ======
CONFIG_TARGET_x86=y
CONFIG_TARGET_x86_64=y
CONFIG_TARGET_x86_64_DEVICE_generic=y

# ====== 分区大小优化 ======
CONFIG_TARGET_KERNEL_PARTSIZE=32
CONFIG_TARGET_ROOTFS_PARTSIZE=2048  # 减少到1GB节省空间

# ====== 编译优化选项 ======
CONFIG_CCACHE=y
CONFIG_BUILD_LOG=y
CONFIG_DEVEL=y
CONFIG_LOCALMIRROR=""

# ====== 基础系统组件 ======
CONFIG_PACKAGE_luci=y
CONFIG_PACKAGE_luci-ssl=y
CONFIG_LUCI_LANG_zh_Hans=y

# ====== 代理工具套装 ======
# OpenClash
CONFIG_PACKAGE_luci-app-openclash=y

# HomeProxy  
CONFIG_PACKAGE_luci-app-homeproxy=y

# PassWall (第一代)
CONFIG_PACKAGE_luci-app-passwall=y
CONFIG_PACKAGE_luci-app-passwall_INCLUDE_Xray=y
CONFIG_PACKAGE_luci-app-passwall_INCLUDE_Hysteria=y
CONFIG_PACKAGE_luci-app-passwall_INCLUDE_Shadowsocks_Rust_Client=y
CONFIG_PACKAGE_luci-app-passwall_INCLUDE_ShadowsocksR_Libev_Client=y
CONFIG_PACKAGE_luci-app-passwall_INCLUDE_V2ray_Geodata=y

# PassWall2 (第二代) - 新增


# ====== Docker 容器支持 ======
CONFIG_PACKAGE_luci-app-dockerman=y
CONFIG_PACKAGE_luci-lib-docker=y
CONFIG_PACKAGE_docker=y
CONFIG_PACKAGE_dockerd=y

# Docker 内核支持
CONFIG_DOCKER_CGROUP_OPTIONS=y
CONFIG_DOCKER_NET_MACVLAN=y
CONFIG_DOCKER_STO_EXT4=y
CONFIG_DOCKER_OPTIONAL_FEATURES=y

# ====== 必要的内核模块 ======
CONFIG_KERNEL_CGROUP_DEVICE=y
CONFIG_KERNEL_CGROUP_FREEZER=y
CONFIG_KERNEL_CGROUP_NET_PRIO=y
CONFIG_KERNEL_NET_CLS_CGROUP=y
CONFIG_KERNEL_EXT4_FS_POSIX_ACL=y
CONFIG_KERNEL_FS_POSIX_ACL=y
CONFIG_KERNEL_MEMCG_SWAP=y
CONFIG_KERNEL_MEMCG_SWAP_ENABLED=y

# ====== 网卡驱动支持 ======
# Intel 网卡
CONFIG_PACKAGE_kmod-igb=y              # Intel Gigabit (I210/I211/I350等)
CONFIG_PACKAGE_kmod-e1000e=y           # Intel PCIe Gigabit (82574L/82579等)
CONFIG_PACKAGE_kmod-igc=y              # Intel 2.5G (I225/I226) ✅ 支持I226
CONFIG_PACKAGE_kmod-e1000=y            # Intel 老式网卡 (可选)

# Realtek 网卡  
CONFIG_PACKAGE_kmod-r8169=y            # Realtek Gigabit (RTL8111/8168等)
CONFIG_PACKAGE_kmod-r8125=y            # Realtek 2.5G (RTL8125)

# 其他厂商网卡 (按需添加)
# CONFIG_PACKAGE_kmod-ixgbe=y          # Intel 10G 网卡
# CONFIG_PACKAGE_kmod-via-velocity=y   # VIA 网卡
# CONFIG_PACKAGE_kmod-sky2=y           # Marvell 网卡
# CONFIG_PACKAGE_kmod-forcedeth=y      # NVIDIA nForce 网卡
# CONFIG_PACKAGE_kmod-tg3=y            # Broadcom Tigon3 网卡

# ====== USB 和存储支持 ======
CONFIG_PACKAGE_kmod-usb-core=y
CONFIG_PACKAGE_kmod-usb2=y
CONFIG_PACKAGE_kmod-usb3=y
CONFIG_PACKAGE_kmod-usb-storage=y

# 文件系统支持
CONFIG_PACKAGE_kmod-fs-ext4=y
CONFIG_PACKAGE_kmod-fs-vfat=y
CONFIG_PACKAGE_kmod-fscache=y

# ====== 引导配置 ======
CONFIG_GRUB_TIMEOUT="3"
CONFIG_GRUB_TITLE="ImmortalWrt"
CONFIG_GRUB_IMAGES=y
CONFIG_GRUB_EFI_IMAGES=y
CONFIG_TARGET_ROOTFS_EXT4FS=y
CONFIG_TARGET_ROOTFS_SQUASHFS=y

# ====== 中文界面支持 ======
CONFIG_PACKAGE_luci-i18n-base-zh-cn=y
CONFIG_PACKAGE_luci-i18n-firewall-zh-cn=y
CONFIG_PACKAGE_luci-i18n-opkg-zh-cn=y
CONFIG_PACKAGE_luci-i18n-dockerman-zh-cn=y
CONFIG_PACKAGE_luci-i18n-passwall-zh-cn=y
CONFIG_PACKAGE_luci-i18n-passwall2-zh-cn=y
CONFIG_PACKAGE_luci-i18n-openclash-zh-cn=y
CONFIG_PACKAGE_luci-i18n-homeproxy-zh-cn=y

# ====== 系统工具 (精简版) ======
CONFIG_PACKAGE_wget-ssl=y
CONFIG_PACKAGE_curl=y
CONFIG_PACKAGE_ca-certificates=y

# ====== 空间优化：禁用的组件 ======
# 禁用大体积功能
# CONFIG_VMDK_IMAGES is not set
# CONFIG_PACKAGE_docker-compose is not set
# CONFIG_PACKAGE_luci-app-samba4 is not set
# CONFIG_PACKAGE_luci-app-aria2 is not set
# CONFIG_PACKAGE_luci-app-transmission is not set
# CONFIG_PACKAGE_ntfs-3g is not set
# CONFIG_PACKAGE_kmod-fs-ntfs is not set

# 禁用调试工具以节省空间
# CONFIG_PACKAGE_htop is not set
# CONFIG_PACKAGE_tcpdump is not set
# CONFIG_PACKAGE_ethtool is not set

# 禁用多余的网卡驱动
# CONFIG_PACKAGE_kmod-ixgbe is not set
# CONFIG_PACKAGE_kmod-via-velocity is not set
# CONFIG_PACKAGE_kmod-sky2 is not set

# 禁用无线相关(x86_64主要用作软路由)
# CONFIG_PACKAGE_hostapd-common is not set
# CONFIG_PACKAGE_wpad-basic-mbedtls is not set

# ====== IPv6 基础支持 ======
CONFIG_PACKAGE_ipv6helper=y
CONFIG_PACKAGE_6in4=y

# ====== 防火墙和网络 ======
CONFIG_PACKAGE_iptables=y
CONFIG_PACKAGE_iptables-mod-tproxy=y
CONFIG_PACKAGE_iptables-mod-extra=y

# ====== SSL/TLS 支持 ======
CONFIG_PACKAGE_libustream-mbedtls=y
CONFIG_PACKAGE_ca-bundle=y

# ====== 其他核心组件 ======
CONFIG_PACKAGE_block-mount=y
CONFIG_PACKAGE_blockd=y

# 注意事项:
# 1. 此配置专门针对空间限制优化
# 2. 根分区大小设置为1GB，如需更多应用可适当增加
# 3. 禁用了部分非必要组件以节省编译时间和空间
# 4. 保留了所有核心代理功能和Docker支持
# 5. 如需其他功能，请谨慎添加以免超出磁盘限制
